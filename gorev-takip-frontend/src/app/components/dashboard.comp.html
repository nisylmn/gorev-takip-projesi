<div class="header-clean">
  <h2>
    ğŸ‘‹ HoÅŸ geldin, <span>{{ userInfo?.fullName }}</span>
  </h2>
  <div class="header-buttons">
    <button (click)="logout()" class="btn-logout">Ã‡Ä±kÄ±ÅŸ Yap</button>
    <button (click)="goToAssign()" class="btn-assign">ğŸ“‹ GÃ¶rev Ata</button>
  </div>
</div>

<div class="add-task-box">
  <h3>â• Yeni GÃ¶rev Ekle</h3>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
    <input [(ngModel)]="newTask.title" placeholder="GÃ¶rev BaÅŸlÄ±ÄŸÄ±" />
    <input [(ngModel)]="newTask.description" placeholder="AÃ§Ä±klama" />
    <input type="date" [(ngModel)]="newTask.startDate" [min]="today" />
    <input type="date" [(ngModel)]="newTask.endDate" [min]="newTask.startDate" />
  </div>

  <button (click)="addTask()">â• GÃ¶rev Ekle</button>
</div>

<div class="my-tasks-section">
  <h2>OluÅŸturduÄŸunuz GÃ¶revler ({{ myCreatedTasks.length }})</h2>
  <p class="section-subtitle">Kendi oluÅŸturduÄŸunuz ve yÃ¶nettiÄŸiniz gÃ¶revler</p>

  <div *ngIf="myCreatedTasks.length === 0" class="no-tasks">HenÃ¼z bir gÃ¶rev oluÅŸturmadÄ±nÄ±z ğŸ’¤</div>

  <div class="tasks-list" *ngIf="myCreatedTasks.length > 0">
    <div
      class="task-card"
      *ngFor="let task of myCreatedTasks"
      [ngClass]="{ completed: task.isCompleted }"
    >
      <div class="task-header">
        <h3 class="task-title">{{ task.title }}</h3>
        <span class="task-status" [ngClass]="{ done: task.isCompleted }">
          {{ task.isCompleted ? 'âœ… TamamlandÄ±' : 'â³ Devam Ediyor' }}
        </span>
      </div>

      <p class="task-description">{{ task.description }}</p>

      <div class="task-dates">
        <div><strong>BaÅŸlangÄ±Ã§:</strong> {{ task.startDate | date : 'dd/MM/yyyy' }}</div>
        <div><strong>BitiÅŸ:</strong> {{ task.endDate | date : 'dd/MM/yyyy' }}</div>
      </div>

      <div class="task-actions">
        <button class="btn btn-primary" (click)="toggleCreatedTaskCompletion(task)">
          {{ task.isCompleted ? 'â†©ï¸ Geri Al' : 'âœ… Tamamla' }}
        </button>
        <button class="btn btn-danger" (click)="deleteCreatedTask(task.id)">ğŸ—‘ï¸ Sil</button>
      </div>
    </div>
  </div>

  <div class="stats-summary" *ngIf="myCreatedTasks.length > 0">
    <div class="stat-item">
      <span class="stat-label">Toplam:</span>
      <span class="stat-value">{{ myCreatedTasks.length }}</span>
    </div>
    <div class="stat-item success">
      <span class="stat-label">Tamamlanan:</span>
      <span class="stat-value">{{ getCreatedCompletedCount() }}</span>
    </div>
    <div class="stat-item warning">
      <span class="stat-label">Devam Eden:</span>
      <span class="stat-value">{{ getCreatedPendingCount() }}</span>
    </div>
  </div>
</div>

<div class="my-tasks-section assigned-section">
  <h2>Size Atanan GÃ¶revler ({{ assignedToMeTasks.length }})</h2>
  <p class="section-subtitle">Size atanmÄ±ÅŸ ve tamamlamanÄ±z beklenen gÃ¶revler</p>

  <div *ngIf="assignedToMeTasks.length === 0" class="no-tasks">Size atanan gÃ¶rev bulunmuyor ğŸ’¤</div>

  <div class="tasks-list" *ngIf="assignedToMeTasks.length > 0">
    <div
      class="task-card assigned-task"
      *ngFor="let task of assignedToMeTasks"
      [ngClass]="{ completed: task.isCompleted }"
    >
      <div class="task-header">
        <h3 class="task-title">{{ task.title }}</h3>
        <span class="task-status" [ngClass]="{ done: task.isCompleted }">
          {{ task.isCompleted ? 'âœ… TamamlandÄ±' : 'â³ Bekliyor' }}
        </span>
      </div>

      <p class="task-description">{{ task.description }}</p>

      <div class="task-dates">
        <div><strong>BaÅŸlangÄ±Ã§:</strong> {{ task.startDate | date : 'dd/MM/yyyy' }}</div>
        <div><strong>BitiÅŸ:</strong> {{ task.endDate | date : 'dd/MM/yyyy' }}</div>
      </div>

      <div class="task-actions">
        <!-- ğŸ”¥ ArtÄ±k tek buton hem tamamla hem geri al yapÄ±yor -->
        <button class="btn btn-success" (click)="toggleAssignedTaskCompletion(task)">
          {{ task.isCompleted ? 'â†©ï¸ Geri Al' : 'âœ… Tamamla' }}
        </button>
      </div>
    </div>
  </div>

  <!-- ğŸ”¹ Ä°statistikler -->
  <div class="stats-summary" *ngIf="assignedToMeTasks.length > 0">
    <div class="stat-item">
      <span class="stat-label">Toplam:</span>
      <span class="stat-value">{{ assignedToMeTasks.length }}</span>
    </div>
    <div class="stat-item success">
      <span class="stat-label">Tamamlanan:</span>
      <span class="stat-value">{{ getAssignedCompletedCount() }}</span>
    </div>
    <div class="stat-item warning">
      <span class="stat-label">Bekleyen:</span>
      <span class="stat-value">{{ getAssignedPendingCount() }}</span>
    </div>
  </div>
</div>
